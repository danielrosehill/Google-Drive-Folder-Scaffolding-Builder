<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial, sans-serif; padding: 20px; }
      .container { max-width: 500px; margin: 0 auto; }
      .form-group { margin-bottom: 15px; }
      .checkbox-group { display: grid; grid-template-columns: repeat(2, 1fr); }
      .success { color: green; }
      .error { color: red; }
      button { margin: 5px; padding: 8px 15px; }
      input[type="text"] { width: 100%; box-sizing: border-box; padding: 5px; }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>Folder Scaffolding Generator</h2>
      <form id="folderForm">
        <div class="form-group">
          <label>Target Folder URL:</label><br>
          <input type="text" id="targetFolder" required>
          <small>Paste Google Drive folder URL here</small>
        </div>
        
        <div class="form-group">
          <label>Select Years:</label>
          <div class="checkbox-group">
            <?!= Array.from({length: 8}, (_, i) => 2023 + i).map(year => `
              <div>
                <input type="checkbox" name="years" value="${year}" id="year${year}">
                <label for="year${year}">${year}</label>
              </div>
            `).join('') ?>
          </div>
        </div>
        
        <div class="form-group">
          <label>Month Format:</label><br>
          <input type="radio" name="monthFormat" value="numeric" id="numericFormat" checked>
          <label for="numericFormat">Numeric (01, 02, ...)</label><br>
          <input type="radio" name="monthFormat" value="named" id="namedFormat">
          <label for="namedFormat">Named (01_Jan, 02_Feb, ...)</label>
        </div>
        
        <div class="form-group">
          <button type="submit" id="generateBtn">Generate Folder Scaffolding</button>
          <button type="button" id="resetBtn">Reset</button>
        </div>
        
        <div id="status"></div>
      </form>
    </div>
    
    <script>
      document.getElementById('folderForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = {
          targetFolder: document.getElementById('targetFolder').value,
          years: Array.from(document.querySelectorAll('input[name="years"]:checked'))
                     .map(cb => cb.value),
          monthFormat: document.querySelector('input[name="monthFormat"]:checked').value
        };
        
        if (formData.years.length === 0) {
          showStatus('Please select at least one year.', false);
          return;
        }
        
        document.getElementById('generateBtn').disabled = true;
        showStatus('Generating folders...', null);
        
        google.script.run
          .withSuccessHandler(function(result) {
            document.getElementById('generateBtn').disabled = false;
            showStatus(result.message, result.success);
          })
          .withFailureHandler(function(error) {
            document.getElementById('generateBtn').disabled = false;
            showStatus('Error: ' + error, false);
          })
          .createFolderStructure(formData);
      });
      
      document.getElementById('resetBtn').addEventListener('click', function() {
        document.getElementById('folderForm').reset();
        document.getElementById('status').innerHTML = '';
      });
      
      function showStatus(message, success) {
        const statusDiv = document.getElementById('status');
        statusDiv.innerHTML = message;
        statusDiv.className = success === null ? '' : (success ? 'success' : 'error');
      }
    </script>
  </body>
</html>